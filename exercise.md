# Project: Adding query params for the Read Model endpoint


<div class="alert alert-dismissible bg-info text-white d-flex flex-column flex-sm-row p-7 mb-10">
    <div class="d-flex flex-column">
        <h3 class="mb-5 text-white">
			Background	
		</h3>
        <span>

The frontend team prepared the frontend for our API, and the operations team is delighted with the new dashboard.
They just need to have one extra feature.
The finance team wants to be able to search for bookings by the receipt issue date, 
so they can double-check the data before sending it to the tax office.

Did we already mention that we shouldn't mess with our finance team? 
Let's implement this before they block our salary transfer. 

</span>
	</div>
	</div>

Read models are excellent in case when we need to provide the search or filtering capabilities.
Especially at scale and on multiple fields that are potentially generated by multiple domains.

Some mid-size companies, decide to use GraphQL for such purposes.
But once you already have an event-driven architecture, you can achieve it much easier with a read model.

Let's do a simple exercise and add a query param to our endpoint.

## Exercise

File: `project/main.go`

In the `GET /ops/bookings` endpoint, add a query param `receipt_issue_date`.
It should accept the date in the format `YYYY-MM-DD`.

If *any* of tickets in the booking has receipt issued at the given date, the booking should be returned.


<div class="accordion" id="hints-accordion">

<div class="accordion-item">
	<h3 class="accordion-header" id="hints-accordion-header-1">
	<button class="accordion-button fs-4 fw-semibold collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#hints-accordion-body-1" aria-expanded="false" aria-controls="hints-accordion">
		Hint #1
	</button>
	</h3>
	<div id="hints-accordion-body-1" class="accordion-collapse collapse" aria-labelledby="hints-accordion-header-1" data-bs-parent="#hints-accordion">
	<div class="accordion-body">

We prepared an example query for you:

```sql
WHERE booking_id IN (
    SELECT booking_id FROM (
        SELECT booking_id, 
            DATE(jsonb_path_query(payload, '$.tickets.*.receipt_issued_at')::text) as receipt_issued_at 
        FROM 
            read_model_ops_bookings
    ) bookings_within_date 
    WHERE receipt_issued_at = $1
)
```

It's not the most efficient query, but it's good enough for our purposes.
If you want an extra exercise, you can try to optimize it.

Of course, it would be much simpler to implement with a database that was designed for search and storing documents,
like Elasticsearch or MongoDB.

</div>
	</div>
	</div>

</div>